---
title: 有關gcp的各種瑣事
summary: 簡單講一下我在gcp曾經遇到的問題...
created: 2026-02-18
tags: 
  - 'mc server'
  - 'Linux'
---

簡單講一下我在gcp曾經遇到的問題，  
這篇文章會以minecraft server所需的工具做主題。  
畢竟gcp這東西太強大了，搞不好未來我還會在其他項目用到他。

## 帳號方面

最簡單又最重要的事項。誰想被莫名其妙收天價賬單啊:)  
但是研究清楚了，就可以一勞永逸。

### 信用卡

「請驗證你是真人」  
這是大公司的慣例，其實比你想像中的還要好通過。  
有些很細的資訊不一定要填，像是我戶籍直接填學校地址。  
最難的一關還是要說服家人。  

喔對了，如果他把你給「鎖住」了，不讓你繼續填資料，  
直接清除快取重新填表格就行，或是開無痕也可以。

### 「帳單帳戶」

gcp為了企業而設計的神奇邏輯，我還是學生看不懂。  
去看影片：
<script>
  import {YouTube} from 'sveltekit-embed'
</script>
<YouTube youTubeId="xrMt-tvHUqs" />
<br />

## VM方面

關於機器設定，還有軟體層級的各種東西。  
其實不是特別重要，畢竟能用就好，多花點時間無所謂（？）

### VM開自訂比較貴

詳情請看圖：

![alt](https://img.littlezhaidi.me/260218gcp/e2-medium.png)
![alt](https://img.littlezhaidi.me/260218gcp/e2-custom.png)

官方是這樣說的：  
> Google 會根據 VM 使用的 vCPU 數量與記憶體時數，收取自訂 VM 費用。  
> 這與預先定義的機器類型計費不同。  
> 自訂機型的以量計價價格，會比預先定義機型的以量計價價格多出 5% 的附加費率。

我只截取部分下來，剩下的可以自己去看：  
[建立採用自訂機型的 VM](https://docs.cloud.google.com/compute/docs/instances/creating-instance-with-custom-machine-type?authuser=1&hl=zh_TW&_gl=1*9nebkv*_ga*MTk1OTc4MDQ5Ni4xNzcxMzk5NjEz*_ga_WH2QY8WWF5*czE3NzEzOTk2MTMkbzEkZzEkdDE3NzE0MDExMDEkajU1JGwwJGgw)  

但其實也不用這麼計較啦，搞不好你開再大記憶體還是會卡（如下圖）  
結果gcp又說你用量太少。  
反正跟小葳說的一樣，能壓在每月100美金以內就行。  

![alt](https://img.littlezhaidi.me/260218gcp/rightsize.png)

還有，小葳說的「永久固定IP」其實會有條件地額外收費，  
如果你哪天忘記你有這個伺服器了（？）  
而且VM關機了，你所「保留」的固定IP就會被收取費用。  

為了避免亂玩的時候忘記這件事，我建議在創建VM時，  
就事先把這個設定關了（其實本來就是關著的）  
因為我還真的被搞過幾次  
當然你不開啟完整帳號，那都不會有事。

### 資料救援

我要說的事情很簡單，但滿重要的。  
就是我上次忘記備份存檔，結果試用期結束了，  
VM也理所當然的被關機了，就沒辦法直接ssh連進去。

這時候沒別的神奇方法，別聽AI在那騙人，  
你就直接升級完整帳號，重啟VM，再備份資料就好。  
我的mc server總檔案大小大概只有2GB，一下就載完了。  
完事之後，馬上去把帳單帳戶給關了，避免意外發生。  
我上次這樣弄，似乎沒被收費（我媽說沒收到帳單），  
我也不清楚google到底是怎麼計價的，反正我沒被收費，  
就把這個經驗分享給大家。

### debian版本

這我不太清楚，你去問arch神教大佬  
但我有感的是 java 跟 python 這一塊。

之前sdkman那篇文章有提到 java11 安裝失敗嘛，  
我猜測原因出在 debian 版本，  
它可能沒有預設幫你弄好安裝所需的環境或是類似的東西。  
python 也是同理，雖然 debian 會幫你裝好 python，  
但就只有那個版本，如果你想要更舊/更新的版本，  
就得自己動手打指令。  
詳情請參考這篇文章：  
[Python versions in Debian and Ubuntu official Docker images](https://gist.github.com/turicas/aabe80601a69287766cb8a4307e0910e
)

怎麼解決 debian 版本差異帶來的問題，我目前還沒什麼頭緒。  
反正我猜未來還會再遇到，之後再研究吧，我懶。

喔對了，如果你遇到 debian 沒辦法用 pip 的問題，  
我之前有寫過一篇文章討論這件事，  
有興趣可以去看看。

### free tier注意事項

這是之前架proxy的時候用到的，  
同理適用於一些小型應用（像是discord bot） 

先看看這部影片，我當初是照著他做的  

<YouTube youTubeId="12goOU6jG9w" />
<br />

然後也確實用了一陣子沒被收費，但有一天我被收了180台幣的帳單。  
我實在是看不懂gcp的報表，只好上網求助（其實是找教學）。  
還好剛才做教學那個人，有再做第二集，  
雖然沒完全解決到我的困擾，但也讓我避掉了很多坑。

首先，最搞的就是那個自動備份。  
你明明說這台VM有free tier折扣，結果又塞個付費服務在裡面？  
創建VM時就先關掉，跟我一樣後來才發現的，  
就照他新影片裡面說的做就好，我就不水文章了。

不能用 cloudflare 的 CDN 也滿神奇的，  
雖然我沒因為這東西被收費過，但確實有點風險。  
而且用了 CDN 其實也沒什麼好處，就順手關掉吧。

我真正遇到的問題似乎是區域開錯，但記不清細節了。  
並不是VM位置有問題，是他的開機硬碟搞錯了。  
但後來就直接停用這個帳號了啦，所以沒有找到對應的解法。

就單純分享一些容易踩雷而被收費的點，  
這東西還是很香的，能讓你很多天馬行空的想法實現。

### image遷移

我還沒試過，到時候成功了再更新

## 網路方面

### 防火牆

稍微聽過各種協議，應該就不會毫無頭緒。  
至少他的各種設定還是比較直觀的，不會說找不到你要的東西。  
如果你要開一個 minecraft server + proxy，  
那就要開`25565`跟`25566`這兩個port。  
如果要架 nginx 網頁伺服器，就要開`80`或是`443`。  
如果是基岩版，就要開 `UDP 19132`。  
我的知識範圍大概就這樣。

### ssh連線

我有遇到兩件比較值得一提的事故，稍微帶過就好。

首先是你只需要一組ssh公私鑰，而且不同VM可以用同一個使用者登入。  
就不會像我一樣，搞了兩組公私鑰，結果把他們搞混了。  
要記得把`config`改一下，具體可以看我之前的文章。  

再來是莫名其妙無法連線的事故。  
我至今為止尚未找到解決方法，而且這非常狠，  
不管是 vscode 跟 gcp 內建的瀏覽器連線，  
都會顯示`connection timeout`，只能等他恢復正常。  
（我印象中不是被擋住，也不是權限不足，就是單純沒有回應）  
時間從半小時到半天不等。  
如果有大佬遇過類似問題，或提到類似的東西，我會馬上更新這個段落。